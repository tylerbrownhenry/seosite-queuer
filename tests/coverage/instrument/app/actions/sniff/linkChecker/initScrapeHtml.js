
var __cov_xiYRLqQ2ZrvD34cRtpwakA = (Function('return this'))();
if (!__cov_xiYRLqQ2ZrvD34cRtpwakA.__coverage__) { __cov_xiYRLqQ2ZrvD34cRtpwakA.__coverage__ = {}; }
__cov_xiYRLqQ2ZrvD34cRtpwakA = __cov_xiYRLqQ2ZrvD34cRtpwakA.__coverage__;
if (!(__cov_xiYRLqQ2ZrvD34cRtpwakA['app/actions/sniff/linkChecker/initScrapeHtml.js'])) {
   __cov_xiYRLqQ2ZrvD34cRtpwakA['app/actions/sniff/linkChecker/initScrapeHtml.js'] = {"path":"app/actions/sniff/linkChecker/initScrapeHtml.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":1,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"enqueueLink","line":8,"loc":{"start":{"line":8,"column":0},"end":{"line":8,"column":37}}},"2":{"name":"scan","line":34,"loc":{"start":{"line":34,"column":0},"end":{"line":34,"column":47}}},"3":{"name":"(anonymous_3)","line":43,"loc":{"start":{"line":43,"column":26},"end":{"line":43,"column":46}}},"4":{"name":"(anonymous_4)","line":46,"loc":{"start":{"line":46,"column":13},"end":{"line":46,"column":30}}},"5":{"name":"(anonymous_5)","line":55,"loc":{"start":{"line":55,"column":24},"end":{"line":55,"column":40}}},"6":{"name":"(anonymous_6)","line":62,"loc":{"start":{"line":62,"column":14},"end":{"line":62,"column":29}}},"7":{"name":"_scan","line":72,"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":35}}},"8":{"name":"Instance","line":73,"loc":{"start":{"line":73,"column":5},"end":{"line":73,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":1,"column":41}},"2":{"start":{"line":2,"column":0},"end":{"line":2,"column":39}},"3":{"start":{"line":3,"column":0},"end":{"line":3,"column":35}},"4":{"start":{"line":4,"column":0},"end":{"line":4,"column":43}},"5":{"start":{"line":5,"column":0},"end":{"line":5,"column":45}},"6":{"start":{"line":6,"column":0},"end":{"line":6,"column":21}},"7":{"start":{"line":8,"column":0},"end":{"line":30,"column":1}},"8":{"start":{"line":10,"column":5},"end":{"line":10,"column":63}},"9":{"start":{"line":12,"column":5},"end":{"line":12,"column":54}},"10":{"start":{"line":14,"column":5},"end":{"line":20,"column":6}},"11":{"start":{"line":15,"column":10},"end":{"line":15,"column":59}},"12":{"start":{"line":16,"column":10},"end":{"line":16,"column":31}},"13":{"start":{"line":17,"column":10},"end":{"line":17,"column":47}},"14":{"start":{"line":18,"column":10},"end":{"line":18,"column":30}},"15":{"start":{"line":19,"column":10},"end":{"line":19,"column":17}},"16":{"start":{"line":22,"column":5},"end":{"line":22,"column":70}},"17":{"start":{"line":23,"column":5},"end":{"line":23,"column":27}},"18":{"start":{"line":25,"column":5},"end":{"line":29,"column":6}},"19":{"start":{"line":26,"column":10},"end":{"line":26,"column":29}},"20":{"start":{"line":27,"column":10},"end":{"line":27,"column":110}},"21":{"start":{"line":28,"column":10},"end":{"line":28,"column":30}},"22":{"start":{"line":32,"column":0},"end":{"line":32,"column":50}},"23":{"start":{"line":34,"column":0},"end":{"line":70,"column":1}},"24":{"start":{"line":36,"column":5},"end":{"line":36,"column":29}},"25":{"start":{"line":37,"column":5},"end":{"line":37,"column":14}},"26":{"start":{"line":38,"column":5},"end":{"line":38,"column":24}},"27":{"start":{"line":40,"column":5},"end":{"line":40,"column":32}},"28":{"start":{"line":41,"column":5},"end":{"line":41,"column":30}},"29":{"start":{"line":43,"column":5},"end":{"line":67,"column":8}},"30":{"start":{"line":44,"column":10},"end":{"line":44,"column":26}},"31":{"start":{"line":45,"column":10},"end":{"line":45,"column":46}},"32":{"start":{"line":48,"column":10},"end":{"line":48,"column":38}},"33":{"start":{"line":49,"column":10},"end":{"line":49,"column":32}},"34":{"start":{"line":51,"column":10},"end":{"line":53,"column":11}},"35":{"start":{"line":52,"column":15},"end":{"line":52,"column":48}},"36":{"start":{"line":55,"column":10},"end":{"line":57,"column":13}},"37":{"start":{"line":56,"column":15},"end":{"line":56,"column":43}},"38":{"start":{"line":59,"column":10},"end":{"line":59,"column":33}},"39":{"start":{"line":60,"column":10},"end":{"line":60,"column":36}},"40":{"start":{"line":63,"column":10},"end":{"line":66,"column":13}},"41":{"start":{"line":69,"column":5},"end":{"line":69,"column":28}},"42":{"start":{"line":72,"column":0},"end":{"line":90,"column":1}},"43":{"start":{"line":73,"column":5},"end":{"line":82,"column":6}},"44":{"start":{"line":74,"column":10},"end":{"line":74,"column":30}},"45":{"start":{"line":75,"column":10},"end":{"line":75,"column":35}},"46":{"start":{"line":76,"column":10},"end":{"line":76,"column":33}},"47":{"start":{"line":77,"column":10},"end":{"line":77,"column":35}},"48":{"start":{"line":78,"column":10},"end":{"line":78,"column":30}},"49":{"start":{"line":79,"column":10},"end":{"line":79,"column":29}},"50":{"start":{"line":80,"column":10},"end":{"line":80,"column":42}},"51":{"start":{"line":81,"column":10},"end":{"line":81,"column":36}},"52":{"start":{"line":83,"column":5},"end":{"line":83,"column":35}},"53":{"start":{"line":84,"column":5},"end":{"line":84,"column":28}},"54":{"start":{"line":85,"column":5},"end":{"line":85,"column":37}},"55":{"start":{"line":86,"column":5},"end":{"line":88,"column":8}},"56":{"start":{"line":89,"column":5},"end":{"line":89,"column":62}},"57":{"start":{"line":92,"column":0},"end":{"line":92,"column":23}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":5},"end":{"line":14,"column":5}},{"start":{"line":14,"column":5},"end":{"line":14,"column":5}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":5},"end":{"line":25,"column":5}},{"start":{"line":25,"column":5},"end":{"line":25,"column":5}}]},"3":{"line":27,"type":"cond-expr","locations":[{"start":{"line":27,"column":80},"end":{"line":27,"column":93}},{"start":{"line":27,"column":96},"end":{"line":27,"column":109}}]},"4":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":10},"end":{"line":51,"column":10}},{"start":{"line":51,"column":10},"end":{"line":51,"column":10}}]},"5":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":14},"end":{"line":51,"column":45}},{"start":{"line":51,"column":49},"end":{"line":51,"column":91}},{"start":{"line":51,"column":95},"end":{"line":51,"column":123}},{"start":{"line":51,"column":127},"end":{"line":51,"column":159}}]}}};
}
__cov_xiYRLqQ2ZrvD34cRtpwakA = __cov_xiYRLqQ2ZrvD34cRtpwakA['app/actions/sniff/linkChecker/initScrapeHtml.js'];
__cov_xiYRLqQ2ZrvD34cRtpwakA.s['1']++;var scrapeHtml=require('./scrapeHtml');__cov_xiYRLqQ2ZrvD34cRtpwakA.s['2']++;var parseHtml=require('./parseHtml');__cov_xiYRLqQ2ZrvD34cRtpwakA.s['3']++;var linkObj=require('./linkObj');__cov_xiYRLqQ2ZrvD34cRtpwakA.s['4']++;var excludeLink=require('./excludeLink');__cov_xiYRLqQ2ZrvD34cRtpwakA.s['5']++;var parseOptions=require('./parseOptions');__cov_xiYRLqQ2ZrvD34cRtpwakA.s['6']++;var q=require('q');function enqueueLink(link,instance){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['1']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['8']++;linkObj.resolve(link,instance.baseUrl,instance.options);__cov_xiYRLqQ2ZrvD34cRtpwakA.s['9']++;var excludedReason=excludeLink(link,instance);__cov_xiYRLqQ2ZrvD34cRtpwakA.s['10']++;if(excludedReason!==false){__cov_xiYRLqQ2ZrvD34cRtpwakA.b['1'][0]++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['11']++;link.html.offsetIndex=instance.excludedLinks++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['12']++;link.excluded=true;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['13']++;link.excludedReason=excludedReason;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['14']++;linkObj.clean(link);__cov_xiYRLqQ2ZrvD34cRtpwakA.s['15']++;return;}else{__cov_xiYRLqQ2ZrvD34cRtpwakA.b['1'][1]++;}__cov_xiYRLqQ2ZrvD34cRtpwakA.s['16']++;link.html.offsetIndex=link.html.index-instance.excludedLinks;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['17']++;link.excluded=false;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['18']++;if(instance.linkEnqueued instanceof Error){__cov_xiYRLqQ2ZrvD34cRtpwakA.b['2'][0]++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['19']++;link.broken=true;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['20']++;link.brokenReason=instance.linkEnqueued.message==='Invalid URI'?(__cov_xiYRLqQ2ZrvD34cRtpwakA.b['3'][0]++,'BLC_INVALID'):(__cov_xiYRLqQ2ZrvD34cRtpwakA.b['3'][1]++,'BLC_UNKNOWN');__cov_xiYRLqQ2ZrvD34cRtpwakA.s['21']++;linkObj.clean(link);}else{__cov_xiYRLqQ2ZrvD34cRtpwakA.b['2'][1]++;}}__cov_xiYRLqQ2ZrvD34cRtpwakA.s['22']++;var RobotDirectives=require('robot-directives');function scan(html,baseUrl,robots,instance){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['2']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['24']++;var promise=q.defer();__cov_xiYRLqQ2ZrvD34cRtpwakA.s['25']++;var tree;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['26']++;var thisObj=this;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['27']++;instance.baseUrl=baseUrl;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['28']++;instance.robots=robots;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['29']++;parseHtml(html).then(function(document){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['3']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['30']++;tree=document;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['31']++;return scrapeHtml(document,robots);}).then(function(links){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['4']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['32']++;instance.foundLinks=links;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['33']++;instance._tree=tree;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['34']++;if((__cov_xiYRLqQ2ZrvD34cRtpwakA.b['5'][0]++,typeof instance!=='undefined')||(__cov_xiYRLqQ2ZrvD34cRtpwakA.b['5'][1]++,typeof instance.foundLinks==='undefined')||(__cov_xiYRLqQ2ZrvD34cRtpwakA.b['5'][2]++,instance.foundLinks===null)||(__cov_xiYRLqQ2ZrvD34cRtpwakA.b['5'][3]++,instance.foundLinks.length===0)){__cov_xiYRLqQ2ZrvD34cRtpwakA.b['4'][0]++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['35']++;return promise.resolve(instance);}else{__cov_xiYRLqQ2ZrvD34cRtpwakA.b['4'][1]++;}__cov_xiYRLqQ2ZrvD34cRtpwakA.s['36']++;_.each(links,function(link){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['5']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['37']++;enqueueLink(link,instance);});__cov_xiYRLqQ2ZrvD34cRtpwakA.s['38']++;instance.parsed=true;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['39']++;promise.resolve(instance);}).catch(function(err){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['6']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['40']++;promise.reject({status:'error',message:err});});__cov_xiYRLqQ2ZrvD34cRtpwakA.s['41']++;return promise.promise;};function _scan(html,url,headers){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['7']++;function Instance(){__cov_xiYRLqQ2ZrvD34cRtpwakA.f['8']++;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['44']++;this.active=false;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['45']++;this.baseUrl=undefined;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['46']++;this.excludedLinks=0;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['47']++;this.linkEnqueued=null;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['48']++;this.parsed=false;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['49']++;this.robots=null;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['50']++;this.options=parseOptions({});__cov_xiYRLqQ2ZrvD34cRtpwakA.s['51']++;this.currentResponse={};}__cov_xiYRLqQ2ZrvD34cRtpwakA.s['52']++;var instance=new Instance();__cov_xiYRLqQ2ZrvD34cRtpwakA.s['53']++;instance.baseUrl=url;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['54']++;instance.currentResponse=html;__cov_xiYRLqQ2ZrvD34cRtpwakA.s['55']++;instance.currentRobots=new RobotDirectives({userAgent:instance.options.userAgent});__cov_xiYRLqQ2ZrvD34cRtpwakA.s['56']++;return scan(html,url,instance.currentRobots,instance);}__cov_xiYRLqQ2ZrvD34cRtpwakA.s['57']++;module.exports=_scan;
