
var __cov_Q2pRr$j4LRXVn9Faa0NEgw = (Function('return this'))();
if (!__cov_Q2pRr$j4LRXVn9Faa0NEgw.__coverage__) { __cov_Q2pRr$j4LRXVn9Faa0NEgw.__coverage__ = {}; }
__cov_Q2pRr$j4LRXVn9Faa0NEgw = __cov_Q2pRr$j4LRXVn9Faa0NEgw.__coverage__;
if (!(__cov_Q2pRr$j4LRXVn9Faa0NEgw['app/actions/scanPage/linkScanner.js'])) {
   __cov_Q2pRr$j4LRXVn9Faa0NEgw['app/actions/scanPage/linkScanner.js'] = {"path":"app/actions/scanPage/linkScanner.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0,0,0,0],"22":[0,0],"23":[0,0],"24":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"fnMap":{"1":{"name":"(anonymous_1)","line":22,"loc":{"start":{"line":22,"column":14},"end":{"line":22,"column":40}}},"2":{"name":"_enqueue","line":33,"loc":{"start":{"line":33,"column":0},"end":{"line":33,"column":34}}},"3":{"name":"(anonymous_3)","line":60,"loc":{"start":{"line":60,"column":12},"end":{"line":60,"column":28}}},"4":{"name":"enqueueLink","line":66,"loc":{"start":{"line":66,"column":0},"end":{"line":66,"column":37}}},"5":{"name":"copyResponseData","line":107,"loc":{"start":{"line":107,"column":0},"end":{"line":107,"column":42}}},"6":{"name":"checkUrl","line":137,"loc":{"start":{"line":137,"column":0},"end":{"line":137,"column":57}}},"7":{"name":"(anonymous_7)","line":160,"loc":{"start":{"line":160,"column":18},"end":{"line":160,"column":38}}},"8":{"name":"(anonymous_8)","line":169,"loc":{"start":{"line":169,"column":14},"end":{"line":169,"column":31}}},"9":{"name":"(anonymous_9)","line":174,"loc":{"start":{"line":174,"column":30},"end":{"line":174,"column":50}}},"10":{"name":"(anonymous_10)","line":184,"loc":{"start":{"line":184,"column":22},"end":{"line":184,"column":39}}},"11":{"name":"(anonymous_11)","line":198,"loc":{"start":{"line":198,"column":21},"end":{"line":198,"column":33}}},"12":{"name":"(anonymous_12)","line":201,"loc":{"start":{"line":201,"column":21},"end":{"line":201,"column":33}}},"13":{"name":"(anonymous_13)","line":219,"loc":{"start":{"line":219,"column":15},"end":{"line":219,"column":32}}}},"statementMap":{"1":{"start":{"line":4,"column":0},"end":{"line":20,"column":51}},"2":{"start":{"line":22,"column":0},"end":{"line":31,"column":2}},"3":{"start":{"line":23,"column":5},"end":{"line":23,"column":19}},"4":{"start":{"line":24,"column":5},"end":{"line":28,"column":6}},"5":{"start":{"line":25,"column":10},"end":{"line":27,"column":12}},"6":{"start":{"line":29,"column":5},"end":{"line":29,"column":42}},"7":{"start":{"line":30,"column":5},"end":{"line":30,"column":22}},"8":{"start":{"line":33,"column":0},"end":{"line":58,"column":1}},"9":{"start":{"line":34,"column":5},"end":{"line":34,"column":50}},"10":{"start":{"line":35,"column":5},"end":{"line":35,"column":23}},"11":{"start":{"line":37,"column":5},"end":{"line":39,"column":6}},"12":{"start":{"line":38,"column":10},"end":{"line":38,"column":42}},"13":{"start":{"line":41,"column":5},"end":{"line":44,"column":6}},"14":{"start":{"line":42,"column":10},"end":{"line":42,"column":34}},"15":{"start":{"line":46,"column":5},"end":{"line":48,"column":6}},"16":{"start":{"line":47,"column":10},"end":{"line":47,"column":44}},"17":{"start":{"line":50,"column":5},"end":{"line":55,"column":7}},"18":{"start":{"line":57,"column":5},"end":{"line":57,"column":15}},"19":{"start":{"line":60,"column":0},"end":{"line":64,"column":2}},"20":{"start":{"line":61,"column":5},"end":{"line":61,"column":27}},"21":{"start":{"line":62,"column":5},"end":{"line":62,"column":26}},"22":{"start":{"line":63,"column":5},"end":{"line":63,"column":17}},"23":{"start":{"line":66,"column":0},"end":{"line":105,"column":1}},"24":{"start":{"line":67,"column":5},"end":{"line":67,"column":63}},"25":{"start":{"line":69,"column":5},"end":{"line":69,"column":54}},"26":{"start":{"line":71,"column":5},"end":{"line":79,"column":6}},"27":{"start":{"line":72,"column":10},"end":{"line":72,"column":59}},"28":{"start":{"line":73,"column":10},"end":{"line":73,"column":31}},"29":{"start":{"line":74,"column":10},"end":{"line":74,"column":47}},"30":{"start":{"line":76,"column":10},"end":{"line":76,"column":22}},"31":{"start":{"line":77,"column":10},"end":{"line":77,"column":54}},"32":{"start":{"line":78,"column":10},"end":{"line":78,"column":17}},"33":{"start":{"line":81,"column":5},"end":{"line":81,"column":70}},"34":{"start":{"line":82,"column":5},"end":{"line":82,"column":27}},"35":{"start":{"line":84,"column":5},"end":{"line":84,"column":61}},"36":{"start":{"line":85,"column":5},"end":{"line":85,"column":65}},"37":{"start":{"line":86,"column":5},"end":{"line":86,"column":65}},"38":{"start":{"line":87,"column":5},"end":{"line":87,"column":65}},"39":{"start":{"line":88,"column":5},"end":{"line":88,"column":65}},"40":{"start":{"line":89,"column":5},"end":{"line":89,"column":65}},"41":{"start":{"line":90,"column":5},"end":{"line":90,"column":65}},"42":{"start":{"line":91,"column":5},"end":{"line":91,"column":65}},"43":{"start":{"line":92,"column":5},"end":{"line":92,"column":65}},"44":{"start":{"line":93,"column":5},"end":{"line":93,"column":65}},"45":{"start":{"line":94,"column":5},"end":{"line":94,"column":65}},"46":{"start":{"line":95,"column":5},"end":{"line":95,"column":65}},"47":{"start":{"line":96,"column":5},"end":{"line":96,"column":65}},"48":{"start":{"line":97,"column":5},"end":{"line":97,"column":65}},"49":{"start":{"line":98,"column":5},"end":{"line":104,"column":6}},"50":{"start":{"line":99,"column":10},"end":{"line":99,"column":29}},"51":{"start":{"line":100,"column":10},"end":{"line":100,"column":110}},"52":{"start":{"line":101,"column":10},"end":{"line":101,"column":53}},"53":{"start":{"line":102,"column":10},"end":{"line":102,"column":22}},"54":{"start":{"line":103,"column":10},"end":{"line":103,"column":54}},"55":{"start":{"line":107,"column":0},"end":{"line":135,"column":1}},"56":{"start":{"line":108,"column":5},"end":{"line":133,"column":6}},"57":{"start":{"line":109,"column":10},"end":{"line":114,"column":11}},"58":{"start":{"line":110,"column":15},"end":{"line":110,"column":34}},"59":{"start":{"line":111,"column":15},"end":{"line":111,"column":65}},"60":{"start":{"line":113,"column":15},"end":{"line":113,"column":35}},"61":{"start":{"line":116,"column":10},"end":{"line":116,"column":40}},"62":{"start":{"line":118,"column":10},"end":{"line":123,"column":11}},"63":{"start":{"line":119,"column":15},"end":{"line":119,"column":50}},"64":{"start":{"line":120,"column":15},"end":{"line":122,"column":16}},"65":{"start":{"line":121,"column":20},"end":{"line":121,"column":64}},"66":{"start":{"line":126,"column":10},"end":{"line":126,"column":29}},"67":{"start":{"line":127,"column":10},"end":{"line":132,"column":11}},"68":{"start":{"line":128,"column":15},"end":{"line":128,"column":60}},"69":{"start":{"line":130,"column":15},"end":{"line":130,"column":49}},"70":{"start":{"line":131,"column":15},"end":{"line":131,"column":44}},"71":{"start":{"line":134,"column":5},"end":{"line":134,"column":17}},"72":{"start":{"line":137,"column":0},"end":{"line":182,"column":1}},"73":{"start":{"line":138,"column":5},"end":{"line":138,"column":16}},"74":{"start":{"line":140,"column":5},"end":{"line":151,"column":6}},"75":{"start":{"line":141,"column":10},"end":{"line":144,"column":11}},"76":{"start":{"line":142,"column":15},"end":{"line":142,"column":36}},"77":{"start":{"line":143,"column":15},"end":{"line":143,"column":55}},"78":{"start":{"line":145,"column":10},"end":{"line":150,"column":11}},"79":{"start":{"line":146,"column":15},"end":{"line":146,"column":34}},"80":{"start":{"line":147,"column":15},"end":{"line":147,"column":49}},"81":{"start":{"line":148,"column":15},"end":{"line":148,"column":35}},"82":{"start":{"line":149,"column":15},"end":{"line":149,"column":44}},"83":{"start":{"line":153,"column":5},"end":{"line":171,"column":8}},"84":{"start":{"line":161,"column":10},"end":{"line":161,"column":46}},"85":{"start":{"line":162,"column":10},"end":{"line":164,"column":11}},"86":{"start":{"line":163,"column":15},"end":{"line":163,"column":67}},"87":{"start":{"line":165,"column":10},"end":{"line":167,"column":11}},"88":{"start":{"line":166,"column":15},"end":{"line":166,"column":68}},"89":{"start":{"line":168,"column":10},"end":{"line":168,"column":26}},"90":{"start":{"line":170,"column":10},"end":{"line":170,"column":23}},"91":{"start":{"line":173,"column":5},"end":{"line":181,"column":6}},"92":{"start":{"line":174,"column":10},"end":{"line":178,"column":13}},"93":{"start":{"line":175,"column":15},"end":{"line":175,"column":57}},"94":{"start":{"line":176,"column":15},"end":{"line":176,"column":40}},"95":{"start":{"line":177,"column":15},"end":{"line":177,"column":27}},"96":{"start":{"line":180,"column":10},"end":{"line":180,"column":25}},"97":{"start":{"line":184,"column":0},"end":{"line":224,"column":1}},"98":{"start":{"line":185,"column":5},"end":{"line":185,"column":29}},"99":{"start":{"line":186,"column":5},"end":{"line":205,"column":6}},"100":{"start":{"line":207,"column":5},"end":{"line":207,"column":27}},"101":{"start":{"line":209,"column":5},"end":{"line":209,"column":30}},"102":{"start":{"line":211,"column":5},"end":{"line":213,"column":8}},"103":{"start":{"line":215,"column":5},"end":{"line":215,"column":33}},"104":{"start":{"line":216,"column":5},"end":{"line":216,"column":33}},"105":{"start":{"line":217,"column":5},"end":{"line":217,"column":75}},"106":{"start":{"line":219,"column":5},"end":{"line":221,"column":8}},"107":{"start":{"line":220,"column":10},"end":{"line":220,"column":33}},"108":{"start":{"line":223,"column":5},"end":{"line":223,"column":17}}},"branchMap":{"1":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":5},"end":{"line":24,"column":5}},{"start":{"line":24,"column":5},"end":{"line":24,"column":5}}]},"2":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":9},"end":{"line":24,"column":34}},{"start":{"line":24,"column":38},"end":{"line":24,"column":70}}]},"3":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":5},"end":{"line":37,"column":5}},{"start":{"line":37,"column":5},"end":{"line":37,"column":5}}]},"4":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":5},"end":{"line":41,"column":5}},{"start":{"line":41,"column":5},"end":{"line":41,"column":5}}]},"5":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":9},"end":{"line":41,"column":19}},{"start":{"line":41,"column":23},"end":{"line":41,"column":54}}]},"6":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":5},"end":{"line":46,"column":5}},{"start":{"line":46,"column":5},"end":{"line":46,"column":5}}]},"7":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":9},"end":{"line":46,"column":40}},{"start":{"line":46,"column":44},"end":{"line":46,"column":76}}]},"8":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":5},"end":{"line":71,"column":5}},{"start":{"line":71,"column":5},"end":{"line":71,"column":5}}]},"9":{"line":98,"type":"if","locations":[{"start":{"line":98,"column":5},"end":{"line":98,"column":5}},{"start":{"line":98,"column":5},"end":{"line":98,"column":5}}]},"10":{"line":100,"type":"cond-expr","locations":[{"start":{"line":100,"column":80},"end":{"line":100,"column":93}},{"start":{"line":100,"column":96},"end":{"line":100,"column":109}}]},"11":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":5},"end":{"line":108,"column":5}},{"start":{"line":108,"column":5},"end":{"line":108,"column":5}}]},"12":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":10},"end":{"line":109,"column":10}},{"start":{"line":109,"column":10},"end":{"line":109,"column":10}}]},"13":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":10},"end":{"line":118,"column":10}},{"start":{"line":118,"column":10},"end":{"line":118,"column":10}}]},"14":{"line":120,"type":"if","locations":[{"start":{"line":120,"column":15},"end":{"line":120,"column":15}},{"start":{"line":120,"column":15},"end":{"line":120,"column":15}}]},"15":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":10},"end":{"line":127,"column":10}},{"start":{"line":127,"column":10},"end":{"line":127,"column":10}}]},"16":{"line":140,"type":"if","locations":[{"start":{"line":140,"column":5},"end":{"line":140,"column":5}},{"start":{"line":140,"column":5},"end":{"line":140,"column":5}}]},"17":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":10},"end":{"line":141,"column":10}},{"start":{"line":141,"column":10},"end":{"line":141,"column":10}}]},"18":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":10},"end":{"line":145,"column":10}},{"start":{"line":145,"column":10},"end":{"line":145,"column":10}}]},"19":{"line":159,"type":"cond-expr","locations":[{"start":{"line":159,"column":39},"end":{"line":159,"column":60}},{"start":{"line":159,"column":63},"end":{"line":159,"column":69}}]},"20":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":10},"end":{"line":162,"column":10}},{"start":{"line":162,"column":10},"end":{"line":162,"column":10}}]},"21":{"line":162,"type":"binary-expr","locations":[{"start":{"line":162,"column":14},"end":{"line":162,"column":41}},{"start":{"line":162,"column":45},"end":{"line":162,"column":62}},{"start":{"line":162,"column":66},"end":{"line":162,"column":98}},{"start":{"line":162,"column":102},"end":{"line":162,"column":131}},{"start":{"line":162,"column":135},"end":{"line":162,"column":148}}]},"22":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":10},"end":{"line":165,"column":10}},{"start":{"line":165,"column":10},"end":{"line":165,"column":10}}]},"23":{"line":165,"type":"binary-expr","locations":[{"start":{"line":165,"column":14},"end":{"line":165,"column":27}},{"start":{"line":165,"column":31},"end":{"line":165,"column":47}}]},"24":{"line":173,"type":"if","locations":[{"start":{"line":173,"column":5},"end":{"line":173,"column":5}},{"start":{"line":173,"column":5},"end":{"line":173,"column":5}}]}}};
}
__cov_Q2pRr$j4LRXVn9Faa0NEgw = __cov_Q2pRr$j4LRXVn9Faa0NEgw['app/actions/scanPage/linkScanner.js'];
__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['1']++;var q=require('q'),defaultOptions=require('./internal/defaultOptions'),UrlChecker=require('./UrlChecker'),isString=require('is-string'),_=require('underscore'),parseHtml=require('./internal/parseHtml'),bhttp=require('bhttp'),matchUrl=require('./internal/matchUrl'),linkObj=require('./internal/linkObj'),simpleResponse=require('./internal/simpleResponse'),maybeCallback=require('maybe-callback'),RobotDirectives=require('robot-directives'),parseOptions=require('./internal/parseOptions'),isString=require('is-string'),excludeLink=require('./internal/excludeLink'),reasons=require('./internal/messages').reasons,getHostKey=require('./internal/getHostKey');__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['2']++;var enqueue=function(input,options){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['1']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['3']++;var idOrError;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['4']++;if((__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['2'][0]++,typeof input==='string')||(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['2'][1]++,input instanceof String===true)){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['1'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['5']++;input={url:input};}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['1'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['6']++;idOrError=_enqueue(input,options);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['7']++;return idOrError;};function _enqueue(input,options){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['2']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['9']++;var hostKey=getHostKey(input.url,options);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['10']++;var id=input.id;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['11']++;if(hostKey===false){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['3'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['12']++;return new Error('Invalid URI');}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['3'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['13']++;if((__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['5'][0]++,id==null)&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['5'][1]++,typeof instance!=='undefined')){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['4'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['14']++;id=instance.counter++;}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['4'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['15']++;if((__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['7'][0]++,typeof instance!=='undefined')&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['7'][1]++,instance.items[id]!==undefined)){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['6'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['16']++;return new Error('Non-unique ID');}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['6'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['17']++;options.items[id]={active:false,hostKey:hostKey,id:id,input:input};__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['18']++;return id;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['19']++;var clean=function(link){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['3']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['20']++;delete link.html.base;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['21']++;delete link.resolved;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['22']++;return link;};function enqueueLink(link,instance){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['4']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['24']++;linkObj.resolve(link,instance.baseUrl,instance.options);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['25']++;var excludedReason=excludeLink(link,instance);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['26']++;if(excludedReason!==false){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['8'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['27']++;link.html.offsetIndex=instance.excludedLinks++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['28']++;link.excluded=true;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['29']++;link.excludedReason=excludedReason;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['30']++;clean(link);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['31']++;maybeCallback(instance.handlers.junk)(link);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['32']++;return;}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['8'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['33']++;link.html.offsetIndex=link.html.index-instance.excludedLinks;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['34']++;link.excluded=false;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['35']++;instance.linkEnqueued=enqueue(link,instance.options);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['36']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['37']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['38']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['39']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['40']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['41']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['42']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['43']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['44']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['45']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['46']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['47']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['48']++;console.log('instance.linkEnqueued',instance.linkEnqueued);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['49']++;if(instance.linkEnqueued instanceof Error){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['9'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['50']++;link.broken=true;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['51']++;link.brokenReason=instance.linkEnqueued.message==='Invalid URI'?(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['10'][0]++,'BLC_INVALID'):(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['10'][1]++,'BLC_UNKNOWN');__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['52']++;link._brokenReason=instance.linkEnqueued;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['53']++;clean(link);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['54']++;maybeCallback(instance.handlers.link)(link);}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['9'][1]++;}}function copyResponseData(response,link){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['5']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['56']++;if(response instanceof Error===false){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['11'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['57']++;if(response.statusCode!==200){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['12'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['58']++;link.broken=true;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['59']++;link.brokenReason='HTTP_'+response.statusCode;}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['12'][1]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['60']++;link.broken=false;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['61']++;link.http.response=response;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['62']++;if(link.url.resolved!==response.url){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['13'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['63']++;link.url.redirected=response.url;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['64']++;if(link.base.resolved!==null){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['14'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['65']++;linkObj.relation(link,link.url.redirected);}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['14'][1]++;}}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['13'][1]++;}}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['11'][1]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['66']++;link.broken=true;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['67']++;if(reasons['ERRNO_'+response.code]!=null){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['15'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['68']++;link.brokenReason='ERRNO_'+response.code;}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['15'][1]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['69']++;link.brokenReason='BLC_UNKNOWN';__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['70']++;link.actualReason=response;}}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['71']++;clean(link);}function checkUrl(link,baseUrl,options,retry,method){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['6']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['73']++;var cached;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['74']++;if(retry===undefined){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['16'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['75']++;if(isString(link)===true){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['17'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['76']++;link=linkObj(link);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['77']++;linkObj.resolve(link,baseUrl,options);}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['17'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['78']++;if(link.url.resolved===null){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['18'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['79']++;link.broken=true;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['80']++;link.brokenReason='BLC_INVALID';__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['81']++;linkObj.clean(link);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['82']++;return Promise.resolve(link);}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['18'][1]++;}}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['16'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['83']++;var request=bhttp.request(link.url.resolved,{discardResponse:true,headers:{'user-agent':options.userAgent},method:retry!==405?(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['19'][0]++,options.requestMethod):(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['19'][1]++,method)}).then(function(response){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['7']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['84']++;response=simpleResponse(response);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['85']++;if((__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['21'][0]++,response.statusCode===405)&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['21'][1]++,method!=='post')&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['21'][2]++,options.requestMethod==='head')&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['21'][3]++,options.retry405Head===true)&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['21'][4]++,retry!==405)){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['20'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['86']++;return checkUrl(link,baseUrl,options,405,'get');}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['20'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['87']++;if((__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['23'][0]++,retry===405)&&(__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['23'][1]++,method==='get')){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['22'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['88']++;return checkUrl(link,baseUrl,options,405,'post');}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['22'][1]++;}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['89']++;return response;}).catch(function(error){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['8']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['90']++;return error;});__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['91']++;if(retry===undefined){__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['24'][0]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['92']++;return request.then(function(response){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['9']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['93']++;copyResponseData(response,link,options);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['94']++;link.http.cached=false;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['95']++;return link;});}else{__cov_Q2pRr$j4LRXVn9Faa0NEgw.b['24'][1]++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['96']++;return request;}}__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['97']++;module.exports.init=function(input){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['10']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['98']++;var promise=q.defer();__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['99']++;var instance={items:{},counter:0,baseUrl:input.baseUrl,options:defaultOptions,excludedLinks:0,linkEnqueued:{message:''},handlers:{junk:function(){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['11']++;},link:function(){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['12']++;}}};__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['100']++;var link=input._link;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['101']++;defaultOptions.items={};__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['102']++;instance.robots=new RobotDirectives({userAgent:instance.options.userAgent});;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['103']++;enqueueLink(link,instance);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['104']++;console.log('checking url');__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['105']++;var resp=checkUrl(link.url.original,input.baseUrl,defaultOptions);__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['106']++;resp.then(function(_link){__cov_Q2pRr$j4LRXVn9Faa0NEgw.f['13']++;__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['107']++;promise.resolve(_link);});__cov_Q2pRr$j4LRXVn9Faa0NEgw.s['108']++;return resp;};
